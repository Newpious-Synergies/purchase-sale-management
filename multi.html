<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Product Table</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            display: none;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        input, select, button {
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            box-sizing: border-box;
        }

        .form-container {
            max-width: 600px;
            margin: auto;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        #exportBtn {
            display: none;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>Dynamic Product Table</h2>

        <label for="saleTo">Sale To:</label>
        <input type="text" id="saleTo" placeholder="Enter sale to">

        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" placeholder="Enter quantity">

        <label for="measurement_units">Measurement Unit:</label>
        <select id="measurement_units">
            <option value="Kg">Kg</option>
            <option value="L">L</option>
            <option value="Pcs">Pcs</option>
            <option value="Dozen">Dozen</option>
        </select>

       <label for="category">Select Category:</label>
<select id="category" name="category" onchange="populateSubOptions()">
    <option value="">--Select Category--</option>
    <option value="VFD Models">VFD Models</option>
    <option value="Credence Solar Panels">Credence Solar Panels</option>
    <option value="Asani Models">Adani Solar Panels</option>
    <option value="All Product Names">All Product Names</option>
    <option value="Veichi Models">Veichi Models</option>
</select>

<!-- Second dropdown: Sub-options -->
<label for="subcategory">Select Product:</label>
<select id="subcategory"  name="product">
    <option value="">--Select Option--</option>
</select>

<script>
    // Data for dropdown options
    const data = {
        "VFD Models": [
            { name: "CG Solar 3Hp VSR23-9P5", value: "CG_Solar_3Hp_VSR23-9P5" },
            { name: "CG Solar 5Hp VSRE48-009", value: "CG_Solar_5Hp_VSRE48-009" },
            { name: "CG Solar 7.5Hp VSR48-013", value: "CG_Solar_7.5Hp_VSR48-013" },
            { name: "CG Solar 10Hp VSR48-017", value: "CG_Solar_10Hp_VSR48-017" },
            { name: "CG Solar 15Hp VSR48-024", value: "CG_Solar_15Hp_VSR48-024" },
            { name: "CG Solar 20Hp VSR48-032", value: "CG_Solar_20Hp_VSR48-032" },
            { name: "CG Solar 25Hp VSR48-038", value: "CG_Solar_25Hp_VSR48-038" },
            { name: "CG Solar 30Hp VSR48-045", value: "CG_Solar_30Hp_VSR48-045" },
            { name: "CG Solar 40Hp VSR48-060", value: "CG_Solar_40Hp_VSR48-060" },
            { name: "CG Solar 50Hp VSR48-075", value: "CG_Solar_50Hp_VSR48-075" },
            { name: "CG Solar 75Hp VSR48-112", value: "CG_Solar_75Hp_VSR48-112" },
            { name: "CG Solar 100Hp VSR48-150", value: "CG_Solar_100Hp_VSR48-150" },
            { name: "CG Solar 150Hp VSR48-210", value: "CG_Solar_150Hp_VSR48-210" }
        ],
        "Credence Solar Panels": [
            { name: "CS-QB685-132", value: "CS_QB685_132" },
            { name: "CSQB670-132", value: "CSQB670_132" },
            { name: "CS-QB725-132", value: "CS_QB725_132" }
        ],
        "Asani Models": [
            { name: "ASB-M10-144-540", value: "ASB_M10_144_540" }
        ],
        "All Product Names": [
            { name: "DCDB", value: "DCDB" },
            { name: "ACDB", value: "ACDB" },
            { name: "Net Meter", value: "Net_Meter" },
            { name: "VFD Box", value: "VFD_Box" },
            { name: "DC cable 4sqr mm", value: "DC_cable_4sqr_mm" },
            { name: "DC cable 6sqr mm", value: "DC_cable_6sqr_mm" },
            { name: "Lug 4Sqr mm", value: "Lug_4Sqr_mm" },
            { name: "Lug 6Sqr mm", value: "Lug_6Sqr_mm" },
            { name: "Lug 35 Sqr mm", value: "Lug_35_Sqr_mm" },
            { name: "MC4 connector", value: "MC4_connector" },
            { name: "Y connecter", value: "Y_connecter" },
            { name: "DC MCB 500v", value: "DC_MCB_500v" },
            { name: "DC MCB 800v", value: "DC_MCB_800v" },
            { name: "DC MCB 125A", value: "DC_MCB_125A" },
            { name: "AC Cable 4Sqr mm", value: "AC_Cable_4Sqr_mm" },
            { name: "AC Cable 2c X 4Sqr mm", value: "AC_Cable_2c_X_4Sqr_mm" },
            { name: "Traminals", value: "Traminals" },
            { name: "Tai cables", value: "Tai_cables" },
            { name: "RMS", value: "RMS" },
            { name: "Earthing Rods", value: "Earthing_Rods" },
            { name: "L.A Latu", value: "L_A_Latu" },
            { name: "Hardwere", value: "Hardwere" },
            { name: "Perlin", value: "Perlin" },
            { name: "Rafter", value: "Rafter" },
            { name: "U clamp", value: "U_clamp" },
            { name: "Z clamp", value: "Z_clamp" },
            { name: "VSR11-9P5", value: "VSR11-9P5" },
        ],
        "Veichi Models": [
            { name: "Veichi 3Hp SD700-6ROD", value: "Veichi_3Hp_SD700_6ROD" },
            { name: "Veichi 5Hp AG300-T/S2-004G", value: "Veichi_5Hp_AG300_T_S2_004G" },
            { name: "Veichi AG300-T3-011G/015P", value: "Veichi_AG300_T3_011G_015P" },
            { name: "Veichi AG300-T3-018G/022P", value: "Veichi_AG300_T3_018G_022P" }
        ]
    };

    // Function to populate the second dropdown based on the first dropdown selection
    function populateSubOptions() {
        const category = document.getElementById("category").value;
        const subcategoryDropdown = document.getElementById("subcategory");

        // Clear previous options
        subcategoryDropdown.innerHTML = '<option value="">--Select Option--</option>';

        // Populate new options
        if (category && data[category]) {
            data[category].forEach(option => {
                const newOption = document.createElement("option");
                newOption.value = option.value; // Unique value for Excel usage
                newOption.textContent = option.name;
                subcategoryDropdown.appendChild(newOption);
            });
        }
    }
</script>

        <label for="date">Date:</label>
        <input type="date" id="date">

        <label for="verifiedBy">Verified By:</label>
        <input type="text" id="verifiedBy" placeholder="Enter verifier's name">

        <button onclick="createRows()">Add to Table</button>
    </div>

    <table id="productTable">
        <thead>
            <tr>
                <th>Sale To</th>
                <th>Quantity</th>
                <th>Unit</th>
                <th>Category</th>
                <th>Subcategory</th>
                <th>Serial Number</th>
                <th>Box Detail</th>
                <th>Date</th>
                <th>Verified By</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <button id="exportBtn" onclick="exportToExcel()">Export to Excel</button>

    <script>
        function createRows() {
            const saleTo = document.getElementById("saleTo").value;
            const quantity = parseInt(document.getElementById("quantity").value, 10);
            const unit = document.getElementById("measurement_units").value;
            const category = document.getElementById("category").value;
            const subcategory = document.getElementById("subcategory").value;
            const date = document.getElementById("date").value;
            const verifiedBy = document.getElementById("verifiedBy").value;

            if (!saleTo || !quantity || !unit || !category || !subcategory || !date || !verifiedBy) {
                alert("Please fill in all fields.");
                return;
            }

            const tableBody = document.getElementById("tableBody");

            for (let i = 0; i < quantity; i++) {
                const row = tableBody.insertRow();

                row.innerHTML = `
                    <td>${saleTo}</td>
                    <td>${1}</td>
                    <td>${unit}</td>
                    <td>${category}</td>
                    <td>${subcategory}</td>
                    <td>
                        <input type="text" placeholder="Enter Serial Number" onchange="updateCellValue(this)">
                    </td>
                    <td style="color:red;">Not Applicable</td>
                    <td>${date}</td>
                    <td>${verifiedBy}</td>
                `;
            }

            document.getElementById("productTable").style.display = "table";
            document.getElementById("exportBtn").style.display = "block";
        }

        function updateCellValue(input) {
            const cell = input.parentElement;
            cell.textContent = input.value; // Replace input field with its value
        }

        function exportToExcel() {
            const table = document.getElementById("productTable");
            const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
            XLSX.writeFile(workbook, "Product_Sales.xlsx");
        }
  </script>
  </body>
</html>
